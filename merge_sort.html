<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Merge Sort Visualizer</title>
  <style>
    body {
      background: #111827;
      color: #f3f4f6;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      user-select: none;
    }
    #main {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: flex-start;
      gap: 40px;
      margin: 40px 0;
      flex-wrap: wrap;
    }
    #visualizer, #codebox {
      background: #21273a;
      border-radius: 12px;
      padding: 24px 20px 20px 20px;
      box-shadow: 0 4px 24px #0005;
      max-width: 720px;
    }
    #visualizer {
      width: 700px;
      min-width: 350px;
    }
    #array {
      display: flex;
      align-items: flex-end;
      height: 180px;
      margin: 24px 0 10px 0;
      background: #181e2b;
      border-radius: 10px;
      position: relative;
    }
    .bar {
      flex: 1;
      margin: 0 4px;
      background: linear-gradient(180deg, #22d3ee 0%, #1d4ed8 100%);
      border-radius: 6px 6px 0 0;
      position: relative;
      min-width: 20px;
      box-shadow: 0 2px 8px #0ef2;
      transition: background 0.25s, height 0.35s cubic-bezier(.34,1.56,.64,1), box-shadow 0.26s;
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }
    .bar .value {
      position: absolute;
      bottom: 6px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 14px;
      font-weight: 700;
      color: #fff;
      background: rgba(32,36,64,0.3);
      padding: 2px 7px;
      border-radius: 8px;
      z-index: 2;
      user-select: none;
      pointer-events: none;
      text-shadow: 0 0 5px #000;
    }
    .bar.comparing {
      background: linear-gradient(180deg, #fbbf24 20%, #f59e0b 90%);
      box-shadow: 0 0 18px 2px #f59e0baa inset;
      z-index: 5;
    }
    .bar.merging {
      background: linear-gradient(180deg, #22c55e 15%, #166534 95%);
      box-shadow: 0 0 22px 2px #166534bb inset;
      z-index: 5;
    }
    .bar.sorted {
      background: linear-gradient(180deg, #a1e887 15%, #22c55e 90%);
      box-shadow: 0 0 22px 5px #22c55ecc inset;
      z-index: 3;
    }
    .pointers {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      user-select: none;
      font-weight: 600;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 13px;
      color: #a7ffeb;
      text-shadow: 0 1px 8px #096c5e55;
      z-index: 100;
    }
    .pointers span {
      background-color: #1a314b;
      padding: 3px 11px;
      border-radius: 6px;
      border: 1.5px solid #22d3ee;
      box-shadow: 0 1px 6px #22d3eecc;
    }
    .pointers .left {
      border-color: #3b82f6;
      background: #2563ebcc;
    }
    .pointers .mid {
      border-color: #a855f7;
      background: #9333eacc;
    }
    .pointers .right {
      border-color: #22c55e;
      background: #15803dcc;
    }
    #explanation {
      font-family: 'Fira Mono', monospace;
      font-size: 18px;
      min-height: 42px;
      margin-top: 12px;
      color: #a7ffeb;
      text-shadow: 0 1px 8px #096c5e33;
      user-select: none;
      line-height: 1.3;
    }
    #controls {
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      align-items: center;
      margin-top: 6px;
    }
    #controls label, #controls input[type=range] {
      font-size: 16px;
      user-select: none;
    }
    #controls button, #controls input[type=range] {
      padding: 7px 14px;
      border-radius: 7px;
      border: none;
      cursor: pointer;
      background: #374151;
      color: #fff;
      box-shadow: 0 2px 4px #0002;
      transition: background 0.18s ease, color 0.18s ease;
      user-select: none;
      font-size: 16px;
      font-weight: 600;
    }
    #controls button:hover {
      background: #22d3ee;
      color: #111;
      box-shadow: 0 0 15px #22d3eeaa;
    }
    #codebox {
      max-width: 480px;
      min-width: 350px;
      font-family: 'Fira Mono', monospace;
      font-size: 14.8px;
      padding: 16px 14px;
      overflow-x: auto;
      height: 75vh;
    }
    pre {
      margin: 0;
      white-space: pre-wrap;
      word-break: break-word;
    }
    #inputbox {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 16px;
      margin-top: 16px;
    }
    #inputbox input {
      flex-grow: 1;
      min-width: 160px;
      font-size: 16px;
      padding: 6.3px 8px;
      border-radius: 6px;
      border: 1.3px solid #1251b0;
      background: #20243d;
      color: #c1d1fb;
      outline: none;
      transition: border-color 0.17s ease;
    }
    #inputbox input:focus {
      border-color: #22d3ee;
      background: #181d37;
    }
    #inputbox button {
      background: #1847a3;
      color: #eee;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.18s ease;
      user-select: none;
    }
    #inputbox button:hover {
      background: #2563eb;
    }
    #purecodebox {
      background:#232c4d;
      margin: 42px auto 44px auto;
      border-radius:13px;
      max-width: 1000px;
      padding: 26px 23px 17px 23px;
      box-shadow: 0 8px 32px #0ecdee20;
      border: 1.8px solid #0f466b28;
      font-family: 'Fira Mono', monospace;
      font-size: 16px;
    }
    #purecodebox strong {
      font-size: 20px;
      font-weight: 700;
      color: #69f3fc;
      display: block;
      margin-bottom: 12px;
      letter-spacing: 0.3px;
    }
    .codes-list {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: flex-start;
    }
    .codes-list pre {
      font-size: 13.8px;
      background: #191e2b;
      border-radius: 7px;
      padding: 14px 12px 12px 12px;
      margin: 7px 0 0 0;
      min-width: 190px;
      max-width: 100%;
      border: 1.2px solid #2d3b54;
      color: #b0e0fa;
      overflow-x: auto;
      line-height: 1.45;
    }
    .codes-list .lang {
      font-size: 15.8px;
      margin-bottom: 4px;
      color: #69f3fc;
    }
    .codes-row {
      display: flex;
      gap: 36px;
      margin-bottom: 16px;
    }
    .codes-row > div {
      flex: 1 1 0;
      min-width: 180px;
      max-width: 100%;
    }
    a { color: #93e7fc; text-decoration: none; font-size: 16px; padding-left: 14px;}
    #codebox strong {font-size: 17.5px; color: #93e7fc; letter-spacing: 0.5px;}
    @media only screen and (max-width: 960px) {
      #main { flex-direction: column; gap: 18px; }
      #visualizer { width: 96vw; min-width: 0; }
      #codebox { max-width: 100vw; }
    }
  </style>
</head>
<body>
<a href="index.html" style="color: #93e7fc; text-decoration: none; font-size: 16px; padding-left: 14px; user-select:none;">← Back to main index</a>
<div id="main">
  <div id="visualizer">
    <div id="controls">
      <label for="sizeSlider">Array size:</label>
      <input type="range" id="sizeSlider" min="7" max="30" value="16" />
      <button onclick="resetArray()">Reset</button>
      <button onclick="start()">▶ Play</button>
      <button onclick="pause()">⏸ Pause</button>
      <button onclick="prevStep()">⏮ Back</button>
      <button onclick="nextStep()">⏭ Next</button>
      <button onclick="stepToStart()">|⏮ Start</button>
      <button onclick="stepToEnd()">End ⏭|</button>
      <label for="speedSlider">Speed:</label>
      <input type="range" id="speedSlider" min="30" max="700" value="270" />
    </div>
    <div id="inputbox">
      <label for="arrayInput">Custom array: </label>
      <input type="text" id="arrayInput" placeholder="e.g. 23,14,8,11,77,32,41,60" />
      <button onclick="useCustomArray()">Use Custom Array</button>
    </div>
    <div id="array"></div>
    <div class="pointers" id="pointersContainer"></div>
    <div id="explanation"></div>
  </div>
  <div id="codebox">
    <strong>Merge Sort Visualizer JavaScript code</strong>
    <pre id="codearea"></pre>
  </div>
</div>
<div id="purecodebox">
    <strong>Pure Merge Sort Code in Java / C++ / Python / JavaScript</strong>
    <div class="codes-list">
      <div class="codes-row">
        <div>
          <div class="lang">Java</div>
          <pre>
 public static void mergeSort(int[] arr, int l, int r) {
   if (l < r) {
     int m = l + (r - l) / 2;
     mergeSort(arr, l, m);
     mergeSort(arr, m + 1, r);
     merge(arr, l, m, r);
   }
 }
 
 public static void merge(int[] arr, int l, int m, int r) {
   int n1 = m - l + 1;
   int n2 = r - m;
 
   int[] L = new int[n1];
   int[] R = new int[n2];
 
   for (int i = 0; i < n1; i++) 
     L[i] = arr[l + i];
   for (int j = 0; j < n2; j++) 
     R[j] = arr[m + 1 + j];
 
   int i = 0, j = 0, k = l;
 
   while (i < n1 && j < n2) {
     if (L[i] <= R[j])
       arr[k++] = L[i++];
     else
       arr[k++] = R[j++];
   }
 
   while (i < n1) 
     arr[k++] = L[i++];
   while (j < n2) 
     arr[k++] = R[j++];
 }
          </pre>
        </div>
        <div>
          <div class="lang">C++</div>
          <pre>
 void mergeSort(std::vector<int>& arr, int l, int r) {
   if (l < r) {
     int m = l + (r - l) / 2;
     mergeSort(arr, l, m);
     mergeSort(arr, m + 1, r);
     merge(arr, l, m, r);
   }
 }
 
 void merge(std::vector<int>& arr, int l, int m, int r) {
   int n1 = m - l + 1;
   int n2 = r - m;
 
   std::vector<int> L(n1);
   std::vector<int> R(n2);
 
   for (int i = 0; i < n1; i++) 
     L[i] = arr[l + i];
   for (int j = 0; j < n2; j++) 
     R[j] = arr[m + 1 + j];
 
   int i = 0, j = 0, k = l;
 
   while (i < n1 && j < n2) {
     if (L[i] <= R[j])
       arr[k++] = L[i++];
     else
       arr[k++] = R[j++];
   }
 
   while (i < n1) 
     arr[k++] = L[i++];
   while (j < n2) 
     arr[k++] = R[j++];
 }
          </pre>
        </div>
      </div>
      <div class="codes-row">
        <div>
          <div class="lang">Python</div>
          <pre>
 def mergeSort(arr):
   if len(arr) > 1:
     mid = len(arr) // 2
     L = arr[:mid]
     R = arr[mid:]
 
     mergeSort(L)
     mergeSort(R)
 
     i = j = k = 0
     while i < len(L) and j < len(R):
       if L[i] <= R[j]:
         arr[k] = L[i]
         i += 1
       else:
         arr[k] = R[j]
         j += 1
       k += 1
 
     while i < len(L):
       arr[k] = L[i]
       i += 1
       k += 1
 
     while j < len(R):
       arr[k] = R[j]
       j += 1
       k += 1
          </pre>
        </div>
        <div>
          <div class="lang">JavaScript</div>
          <pre>
 function mergeSort(arr) {
   if (arr.length <= 1) return arr;
 
   const mid = Math.floor(arr.length / 2);
   const left = mergeSort(arr.slice(0, mid));
   const right = mergeSort(arr.slice(mid));
   const merged = [];
 
   let i = 0, j = 0;
 
   while (i < left.length && j < right.length) {
     if (left[i] <= right[j]) 
       merged.push(left[i++]);
     else 
       merged.push(right[j++]);
   }
 
   return merged.concat(left.slice(i)).concat(right.slice(j));
 }
          </pre>
        </div>
      </div>
    </div>
  </div>
  
  <div id="info-section" style="background:#1f2937; color:#e3f7fa; border-radius:12px; max-width:900px; margin:28px auto 18px auto; padding:24px 22px; box-shadow:0 4px 18px #1e293b30;"> <h2 style="margin-top:0; color: #93e7fc;">Merge Sort: Complexity & Key Points</h2> <ul style="margin:0 0 12px 24px; font-size:16px;"> <li><strong>Worst-case time complexity:</strong> <code>O(n log n)</code></li> <li><strong>Best-case time complexity:</strong> <code>O(n log n)</code></li> <li><strong>Average-case time complexity:</strong> <code>O(n log n)</code></li> <li><strong>Space complexity:</strong> <code>O(n)</code> (due to temporary arrays for merging)</li> </ul> <ul style="margin:0 0 0 24px; font-size:16px;"> <li>Divide and conquer algorithm: recursively splits array into halves, then merges sorted halves.</li> <li>Stable sort: maintains relative order of equal elements.</li> <li>Not in-place: requires extra memory for temporary arrays during merging.</li> <li>Consistent and predictable performance for all input types.</li> <li>Widely used for large datasets and external sorting scenarios.</li> <li>Visualization shows the recursive splitting and merging process clearly.</li> </ul> </div>

<script>
const codeLines = [
  "async function mergeSort(array, left, right, render, sleep) {",
  "  if (left < right) {",
  "    const mid = Math.floor((left + right) / 2);",
  "    render([], [], {left, mid, right}, false, `Divide: left=${left}, mid=${mid}, right=${right}`);",
  "    await sleep();",
  "    await mergeSort(array, left, mid, render, sleep);",
  "    await mergeSort(array, mid + 1, right, render, sleep);",
  "    await merge(array, left, mid, right, render, sleep);",
  "  }",
  "}",
  "async function merge(array, left, mid, right, render, sleep) {",
  "  const temp = [];",
  "  let i = left, j = mid + 1;",
  "  while (i <= mid && j <= right) {",
  "    render([i, j], [], {left, mid, right}, false, `Compare ${array[i]} and ${array[j]}`);",
  "    await sleep();",
  "    if (array[i] <= array[j]) {",
  "      temp.push(array[i++]);",
  "    } else {",
  "      temp.push(array[j++]);",
  "    }",
  "  }",
  "  while (i <= mid) temp.push(array[i++]);",
  "  while (j <= right) temp.push(array[j++]);",
  "  for (let k = left; k <= right; k++) {",
  "    array[k] = temp[k - left];",
  "    render([], [k], {left, mid, right}, true, `Place ${temp[k-left]} at position ${k}`);",
  "    await sleep();",
  "  }",
  "}"
];

const ARRAY_MIN = 7, ARRAY_MAX = 30;
const NUM_MIN = 10, NUM_MAX = 200;
let array = [], states = [], stateIdx = 0, animating = false, paused = false, timeoutID = null;

const arrayContainer = document.getElementById('array');
const sizeSlider = document.getElementById('sizeSlider');
const speedSlider = document.getElementById('speedSlider');
const codearea = document.getElementById('codearea');
const explanationBox = document.getElementById('explanation');
const pointersContainer = document.getElementById('pointersContainer');

function randomArray(size) {
  return Array.from({ length: size }, () =>
    Math.floor(Math.random() * (NUM_MAX - NUM_MIN + 1)) + NUM_MIN
  );
}

function renderArray(comparing = [], sorted = [], pointers = {}, merging = false, desc = '') {
  arrayContainer.innerHTML = '';
  pointersContainer.innerHTML = '';

  array.forEach((val, idx) => {
    const bar = document.createElement('div');
    bar.className = 'bar';
    if (comparing.includes(idx)) bar.classList.add('comparing');
    if (!merging && sorted.includes(idx)) bar.classList.add('sorted');
    if (merging) bar.classList.add('merging');
    bar.style.height = val + 'px';
    const pointerSpans = [];

    if (pointers.left === idx) pointerSpans.push(`<span class="left">L</span>`);
    if (pointers.mid === idx) pointerSpans.push(`<span class="mid">M</span>`);
    if (pointers.right === idx) pointerSpans.push(`<span class="right">R</span>`);

    bar.innerHTML = pointerSpans.join('') + `<div class="value">${val}</div>`;

    arrayContainer.appendChild(bar);
  });

  explanationBox.textContent = desc;
}

function snapshot(arr, comparing = [], sorted = [], pointers = {}, merging = false, desc = '') {
  states.push({
    arr: arr.slice(),
    comparing: comparing.slice(),
    sorted: sorted.slice(),
    pointers: { ...pointers },
    merging,
    desc,
  });
}

async function captureMergeSortSteps() {
  states = [];

  async function mergeSortRec(arr, left, right, sorted) {
    if (left >= right) {
      return;
    }
    let mid = Math.floor((left + right) / 2);
    snapshot(arr, [], sorted, { left, mid, right }, false, `Divide: left=${left}, mid=${mid}, right=${right}`);
    await new Promise(r => setTimeout(r, 0));

    await mergeSortRec(arr, left, mid, sorted);
    await mergeSortRec(arr, mid + 1, right, sorted);

    await merge(arr, left, mid, right, sorted);
  }

  async function merge(arr, left, mid, right, sorted) {
    let temp = [];
    let i = left, j = mid + 1;

    while (i <= mid && j <= right) {
      snapshot(arr, [i, j], sorted, { left, mid, right }, false, `Compare: arr[${i}] = ${arr[i]} and arr[${j}] = ${arr[j]}`);
      await new Promise(r => setTimeout(r, 0));

      if (arr[i] <= arr[j]) {
        temp.push(arr[i]);
        i++;
      } else {
        temp.push(arr[j]);
        j++;
      }
    }
    while (i <= mid) temp.push(arr[i++]);
    while (j <= right) temp.push(arr[j++]);

    for (let k = left; k <= right; k++) {
      arr[k] = temp[k - left];
      snapshot(arr, [], sorted, { left, mid, right }, true, `Placed ${arr[k]} at position ${k}`);
      await new Promise(r => setTimeout(r, 0));
    }
  }

  const sortedIndices = [];
  await mergeSortRec(array, 0, array.length - 1, sortedIndices);
  snapshot(array, [], Array.from(Array(array.length).keys()), {}, false, 'Array sorted!');
}

function resetArray() {
  if (animating) return;
  array = randomArray(Number(sizeSlider.value));
  renderArray();
  displayCode(-1);
  states = [];
  stateIdx = 0;
  explanationBox.textContent = '';
}
function useCustomArray() {
  const val = document.getElementById('arrayInput').value.trim();
  const customArr = val.split(',').map(s => +s.trim()).filter(x => !isNaN(x) && x >= NUM_MIN && x <= NUM_MAX);
  if (customArr.length < ARRAY_MIN || customArr.length > ARRAY_MAX) {
    alert(`Please enter between ${ARRAY_MIN} and ${ARRAY_MAX} integers (${NUM_MIN}-${NUM_MAX}) comma separated`);
    return;
  }
  array = customArr;
  renderArray();
  displayCode(-1);
  states = [];
  stateIdx = 0;
  explanationBox.textContent = '';
}

async function start() {
  if (animating) return;
  animating = true;
  paused = false;
  states = [];
  stateIdx = 0;
  await captureMergeSortSteps();
  nextStep();
}

function pause() {
  paused = true;
  animating = false;
  if (timeoutID) clearTimeout(timeoutID);
}

function nextStep() {
  if (stateIdx >= states.length) {
    animating = false;
    displayCode(-1);
    explanationBox.textContent = '';
    return;
  }
  const s = states[stateIdx];
  array = s.arr.slice();
  renderArray(s.comparing, s.sorted, s.pointers, s.merging, s.desc);
  displayCode(-1);
  stateIdx++;
  if (animating && !paused) {
    timeoutID = setTimeout(nextStep, 650 - Number(speedSlider.value));
  }
}
function prevStep() {
  if (stateIdx > 1) {
    stateIdx -= 2;
    nextStep();
  }
}
function stepToStart() {
  stateIdx = 0;
  nextStep();
}
function stepToEnd() {
  stateIdx = states.length - 1;
  nextStep();
}
function displayCode(hl) {
  codearea.innerHTML = '';
  codeLines.forEach((line, idx) => {
    const el = document.createElement('span');
    el.className = 'codeline' + (idx === hl ? ' highlight' : '');
    el.textContent = line;
    codearea.appendChild(el);
    codearea.appendChild(document.createTextNode('\n'));
  });
}
sizeSlider.addEventListener('input', () => {
  if (!animating) resetArray();
});


resetArray();
displayCode(-1);
</script>
</body>
</html>
